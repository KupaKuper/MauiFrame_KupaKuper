<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:KupaKuper_HmiView.ContentViewModes"
             x:DataType="local:VisionImangViewVM"
             x:Class="KupaKuper_HmiView.ContentViews.VisionImangView"
             x:Name="VisionView">
    <ContentView.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/MyStyles.xaml;assembly=KupaKuper_MauiControl" />
                <ResourceDictionary Source="/Resources/MyStyles.xaml;assembly=KupaKuper_HmiView" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </ContentView.Resources>
    <Grid RowDefinitions="*" ColumnDefinitions="250,*,250">
        <!-- 左侧文件夹树状视图 -->
        <Border Grid.Column="0" 
                Margin="5"
                Stroke="{StaticResource Gray300}"
                StrokeThickness="1">
            <CollectionView ItemsSource="{Binding FolderStructure}"
                          SelectedItem="{Binding SelectedFolder, Mode=TwoWay}"
                          SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="local:FolderItem">
                        <Grid Padding="10,5">
                            <Label Text="{Binding Name}"
                                   FontSize="14"/>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Border>

        <!-- 中间图片显示区域 -->
        <Grid Grid.Column="1" 
              Margin="5"
              RowDefinitions="*">
            
            <!-- 图片显示区域的主容器 -->
            <Border Grid.Row="0"
                    Stroke="{StaticResource Gray300}"
                    StrokeThickness="1">
                <Grid ColumnDefinitions="auto,*,auto" Padding="1">
                    <!-- 左侧导航按钮 -->
                    <Button Grid.Column="0"
                            Text="＜"
                            Command="{Binding PreviousImageCommand}"
                            IsVisible="{Binding CanNavigateImages}"
                            ToolTipProperties.Text="{Binding PreviousImageTooltip}"
                            VerticalOptions="Center"
                            HorizontalOptions="Start"
                            BackgroundColor="{Binding PreviousButtonBackground}"
                            TextColor="{StaticResource Black}"
                            Margin="10,0"
                            Opacity="0.7"
                            FontSize="24"
                            x:Name="PreviousButton"/>

                    <!-- 简单的图片显示控件 -->
                    <Image Grid.Column="1"
                           x:Name="ImageControl"
                           Source="{Binding CurrentImage}"
                           Aspect="AspectFit"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"/>
                    
                    <!-- 右侧导航按钮 -->
                    <Button Grid.Column="2"
                            Text="＞"
                            Command="{Binding NextImageCommand}"
                            IsVisible="{Binding CanNavigateImages}"
                            ToolTipProperties.Text="{Binding NextImageTooltip}"
                            VerticalOptions="Center"
                            HorizontalOptions="End"
                            BackgroundColor="{Binding NextButtonBackground}"
                            TextColor="{StaticResource Black}"
                            Margin="10,0"
                            Opacity="0.7"
                            FontSize="24"
                            x:Name="NextButton"/>
                    
                    <!-- 无图片时的提示文本 -->
                    <Label Text="没有选择图片"
                           IsVisible="{Binding IsNoImage}"
                           HorizontalOptions="Start"
                           VerticalOptions="Start"
                           FontSize="20"/>
                </Grid>
            </Border>
        </Grid>

        <!-- 右侧图片信息显示 -->
        <Border Grid.Column="2"
                Margin="5"
                Stroke="{StaticResource Gray300}"
                StrokeThickness="1">
            <ScrollView>
                <VerticalStackLayout Padding="10" Spacing="10">
                    <Label Text="图片信息" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           HorizontalOptions="Center"/>
                    
                    <BoxView HeightRequest="1" 
                            Color="{StaticResource Gray300}"
                            Margin="0,5"/>
                    
                    <Label Text="文件路径:" 
                           FontAttributes="Bold"/>
                    <Label Text="{Binding CurrentImagePath}"
                           TextColor="Blue"
                           LineBreakMode="WordWrap"
                           MaxLines="3"/>
                    <Button Text="打开文件位置"
                            Command="{Binding OpenFileLocationCommand}"
                            BackgroundColor="{StaticResource blueColor}"
                            HorizontalOptions="Start"
                            Margin="0,5,0,0"/>
                    
                    <Label Text="创建时间:" 
                           FontAttributes="Bold"
                           Margin="0,10,0,0"/>
                    <Label Text="{Binding CurrentImageCreateTime}"/>
                    
                    <Label Text="修改时间:" 
                           FontAttributes="Bold"
                           Margin="0,10,0,0"/>
                    <Label Text="{Binding CurrentImageModifyTime}"/>
                    
                    <Label Text="文件大小:" 
                           FontAttributes="Bold"
                           Margin="0,10,0,0"/>
                    <Label Text="{Binding CurrentImageSize}"/>
                    
                </VerticalStackLayout>
            </ScrollView>
        </Border>
    </Grid>
</ContentView>
