<?xml version="1.0" encoding="utf-8" ?>
<!-- 其他参数设置视图的主要布局文件 -->
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="KupaKuper_HmiView.ContentViews.OtherView"
             xmlns:mycontrol="clr-namespace:KupaKuper_MauiControl.Controls;assembly=KupaKuper_MauiControl"
             xmlns:local="clr-namespace:KupaKuper_HmiView.ContentViewModes"
             x:DataType="local:OtherViewVM"
             xmlns:localization="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui">
    <ContentView.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/MyStyles.xaml;assembly=KupaKuper_MauiControl" />
                <ResourceDictionary Source="/Resources/MyStyles.xaml;assembly=KupaKuper_HmiView" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </ContentView.Resources>
    <!-- 主布局网格，分为左右两列，左侧固定宽度250 -->
    <Grid ColumnDefinitions="250,*">
        <!-- 左侧参数分组列表面板 -->
        <Border Grid.Column="0" 
                Margin="5"
                Stroke="{StaticResource Gray300}"
                StrokeThickness="1"
                StrokeShape="RoundRectangle 5">
            <!-- 参数组列表 -->
            <CollectionView ItemsSource="{Binding ParameterListName}"
                          SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="x:String">
                        <!-- 每个参数组的按钮布局 -->
                        <Grid Padding="10,5">
                            <!-- 自定义参数组选择按钮 -->
                            <mycontrol:HmiButton Text="{Binding .}"
                                   Command="{Binding Source={RelativeSource AncestorType={x:Type local:OtherViewVM}}, Path=SwitchGroupCommand}"
                                   CommandParameter="{Binding .}"
                                   Clicked="Button_Clicked"
                                   Style="{StaticResource HmiButtonStyle}"/>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Border>

        <!-- 右侧参数显示区域 -->
        <Border Grid.Column="1"
                Margin="5"
                Stroke="{StaticResource Gray300}"
                StrokeThickness="1"
                StrokeShape="RoundRectangle 5">
            <!-- 添加滚动视图支持 -->
            <ScrollView>
                <!-- 参数列表 -->
                <CollectionView ItemsSource="{Binding CurrentParameters}"
                              Margin="10">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="local:ParameterData">
                            <!-- 每个参数项的布局 -->
                            <Grid ColumnDefinitions="*,Auto" 
                                  BackgroundColor="Transparent"
                                  Padding="10,5">
                                <!-- 参数名称标签 -->
                                <Label Grid.Column="0"
                                       Text="{Binding Config.Name}"
                                       HeightRequest="40"
                                       VerticalTextAlignment="Center"
                                       BackgroundColor="{AppThemeBinding Dark={StaticResource DarkButtonColor}, Light={StaticResource LightButtonColor}}"
                                       TextColor="{AppThemeBinding Dark={StaticResource DarkTextColor}, Light={StaticResource LightTextColor}}"
                                       VerticalOptions="Center"
                                       Padding="10,0,0,0"/>
                                
                                <!-- 参数值编辑区域：根据参数类型显示不同控件 -->
                                <Grid WidthRequest="60" 
                                      HeightRequest="40"
                                      Grid.Column="1" 
                                      HorizontalOptions="End" 
                                      BackgroundColor="{AppThemeBinding Dark={StaticResource DarkButtonColor}, Light={StaticResource LightButtonColor}}">
                                    <!-- 布尔类型参数使用开关控件 -->
                                    <Switch IsVisible="{Binding IsBooleanType}"
                                            IsToggled="{Binding Value}"
                                            BackgroundColor="{AppThemeBinding Dark={StaticResource DarkButtonColor}, Light={StaticResource LightButtonColor}}"
                                            HorizontalOptions="End"
                                            VerticalOptions="Center"
                                            Toggled="Switch_Toggled"/>

                                    <!-- 数值类型参数使用数字输入框 -->
                                    <mycontrol:HmiNumberBox 
                                            IsVisible="{Binding IsNumericType}"
                                            Text="{Binding NumericValue}"
                                            Var="{Binding Config.plcVar}"
                                            FontSize="16"
                                            HorizontalTextAlignment="Start"
                                            Style="{StaticResource LableStyle}"
                                            EnterNumber="HmiNumberBox_ValueChanged"
                                            HmiNumberBox_Click="tBox_RelPosition_HmiNumberBox_Click" />
                                </Grid>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </ScrollView>
        </Border>
    </Grid>
</ContentView>
